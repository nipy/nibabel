<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Neuroimaging in Python &#8212; NiBabel 5.4.0.dev1+g3b1c7b37 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/nibabel.css?v=f6107aeb" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <script src="../_static/documentation_options.js?v=8f87c9ba"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced Testing" href="advanced_testing.html" />
    <link rel="prev" title="BrainVoyager file formats" href="bv_formats.html" />
  <meta name="keywords" content="nipy, neuroimaging, python, neuroscience">

  </head><body>
<div class="row" style="display: flex; flex-direction: row; flex-wrap: wrap; width: 100%;">
  <div class="column" style="background-color: white; display: flex; flex-direction: column; flex: 0 0 140px; padding-left: 2px; padding-bottom:2px; padding-top:2px;">
    <img src="../_static/nibabel-logo.svg" class="logo" alt="Logo" width="130px"/>
  </div>
  <div class="column" style="background-color: white; text-align: left; padding-left: 10px; padding-bottom:50px; padding-top:20px; background-repeat: no-repeat; display: flex; flex-direction: column; flex-basis: 100%; flex: 1;">
    <h1>NiBabel</h1>
    <h3 style="margin-top:-5px;color:#2f83c8">Access a cacophony of neuro-imaging file formats</h3>
  </div>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="advanced_testing.html" title="Advanced Testing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bv_formats.html" title="BrainVoyager file formats"
             accesskey="P">previous</a> |</li>
  <li><a href="http://nipy.org/">Community</a> |&nbsp;</li>
  <li><a href="../index.html">NiBabel Home</a> |&nbsp;</li>
  <li><a href="https://mail.python.org/mailman/listinfo/neuroimaging">Mailing list</a> |&nbsp;</li>
  <li><a href="legal.html">License</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Developer documentation page</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Neuroimaging in Python</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">A guide to making a nibabel release</a><ul>
<li><a class="reference internal" href="#release-checklist">Release checklist</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="bv_formats.html"
                          title="previous chapter">BrainVoyager file formats</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="advanced_testing.html"
                          title="next chapter">Advanced Testing</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/devel/make_release.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="a-guide-to-making-a-nibabel-release">
<span id="release-guide"></span><h1>A guide to making a nibabel release<a class="headerlink" href="#a-guide-to-making-a-nibabel-release" title="Link to this heading">¶</a></h1>
<p>This is a guide for developers who are doing a nibabel release.</p>
<p>The general idea of these instructions is to go through the following steps:</p>
<ul class="simple">
<li><p>Make sure that the code is in the right state for release;</p></li>
<li><p>update release-related docs such as the Changelog;</p></li>
<li><p>update various documents giving dependencies, dates and so on;</p></li>
<li><p>check all standard and release-specific tests pass;</p></li>
<li><p>make the <em>release commit</em> and release tag;</p></li>
<li><p>check Windows binary builds and slow / big memory tests;</p></li>
<li><p>push source and windows builds to pypi;</p></li>
<li><p>push docs;</p></li>
<li><p>push release commit and tag to github;</p></li>
<li><p>announce.</p></li>
</ul>
<p>We leave pushing the tag to the last possible moment, because it’s very bad
practice to change a git tag once it has reached the public servers (in our
case, github).  So we want to make sure of the contents of the release before
pushing the tag.</p>
<section id="release-checklist">
<span id="id1"></span><h2>Release checklist<a class="headerlink" href="#release-checklist" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Review the open list of <a class="reference external" href="https://github.com/nipy/nibabel/issues">nibabel issues</a>.  Check whether there are
outstanding issues that can be closed, and whether there are any issues that
should delay the release.  Label them !</p></li>
<li><p>Review and update the release notes.  Review and update the <code class="docutils literal notranslate"><span class="pre">Changelog</span></code>
file.  Get a partial list of contributors with something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">log</span> <span class="mf">2.0.0</span><span class="o">..</span> <span class="o">|</span> <span class="n">grep</span> <span class="s1">&#39;^Author&#39;</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span><span class="s1">&#39; &#39;</span> <span class="o">-</span><span class="n">f</span> <span class="mi">2</span><span class="o">-</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">2.0.0</span></code> was the last release tag name.</p>
<p>Then manually go over <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">shortlog</span> <span class="pre">2.0.0..</span></code> to make sure the release
notes are as complete as possible and that every contributor was recognized.</p>
</li>
<li><p>Look at <code class="docutils literal notranslate"><span class="pre">doc/source/index.rst</span></code> and add any authors not yet acknowledged.
You might want to use the following to list authors by the date of their
contributions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">log</span> <span class="o">--</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%a</span><span class="s2">N &lt;</span><span class="si">%a</span><span class="s2">E&gt;&quot;</span> <span class="o">--</span><span class="n">reverse</span> <span class="o">|</span> <span class="n">perl</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;my </span><span class="si">%d</span><span class="s1">edupe; while (&lt;STDIN&gt;) { print unless $dedupe{$_}++}&#39;</span>
</pre></div>
</div>
<p>(From:
<a class="reference external" href="http://stackoverflow.com/questions/6482436/list-of-authors-in-git-since-a-given-commit#6482473">http://stackoverflow.com/questions/6482436/list-of-authors-in-git-since-a-given-commit#6482473</a>)</p>
<p>Consider any updates to the <code class="docutils literal notranslate"><span class="pre">AUTHOR</span></code> file.</p>
</li>
<li><p>Use the opportunity to update the <code class="docutils literal notranslate"><span class="pre">.mailmap</span></code> file if there are any
duplicate authors listed from <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">shortlog</span> <span class="pre">-nse</span></code>.</p></li>
<li><p>Check the copyright year in <code class="docutils literal notranslate"><span class="pre">doc/source/conf.py</span></code></p></li>
<li><p>Refresh the <code class="docutils literal notranslate"><span class="pre">README.rst</span></code> text from the <code class="docutils literal notranslate"><span class="pre">LONG_DESCRIPTION</span></code> in <code class="docutils literal notranslate"><span class="pre">info.py</span></code>
by running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">refresh-readme</span></code>.</p>
<p>Check the output of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rst2html</span><span class="o">.</span><span class="n">py</span> <span class="n">README</span><span class="o">.</span><span class="n">rst</span> <span class="o">&gt;</span> <span class="o">~/</span><span class="n">tmp</span><span class="o">/</span><span class="n">readme</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>because this will be the output used by <a class="reference external" href="https://pypi.python.org/pypi">pypi</a></p>
</li>
<li><p>Check the dependencies listed in <code class="docutils literal notranslate"><span class="pre">nibabel/info.py</span></code> (e.g.
<code class="docutils literal notranslate"><span class="pre">NUMPY_MIN_VERSION</span></code>) and in <code class="docutils literal notranslate"><span class="pre">doc/source/installation.rst</span></code> and in
<code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">.travis.yml</span></code>.  They should at least match. Do
they still hold?  Make sure <a class="reference external" href="https://travis-ci.org/nipy/nibabel">nibabel on travis</a> is testing the minimum
dependencies specifically.</p></li>
<li><p>Do a final check on the <a class="reference external" href="https://nipy.bic.berkeley.edu">nipy buildbot</a>.  Use the <code class="docutils literal notranslate"><span class="pre">try_branch.py</span></code>
scheduler available in <a class="reference external" href="https://github.com/nipy/nibotmi">nibotmi</a> to test particular schedulers.</p></li>
<li><p>Make sure all tests pass (from the nibabel root directory):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">doctest</span><span class="o">-</span><span class="n">modules</span> <span class="n">nibabel</span>
</pre></div>
</div>
</li>
<li><p>Make sure you are set up to use the <code class="docutils literal notranslate"><span class="pre">try_branch.py</span></code> - see
<a class="reference external" href="https://github.com/nipy/nibotmi/blob/master/install.rst#trying-a-set-of-changes-on-the-buildbots">https://github.com/nipy/nibotmi/blob/master/install.rst#trying-a-set-of-changes-on-the-buildbots</a></p></li>
<li><p>Make sure all your changes are committed or removed, because
<code class="docutils literal notranslate"><span class="pre">try_branch.py</span></code> pushes up the changes in the working tree;</p></li>
<li><p>The following checks get run with the <code class="docutils literal notranslate"><span class="pre">nibabel-release-checks</span></code>, as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">checks</span>
</pre></div>
</div>
<p>Beware: this build does not usually error, even if the steps do not give the
expected output.  You need to check the output manually by going to
<a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-release-checks">https://nipy.bic.berkeley.edu/builders/nibabel-release-checks</a> after the
build has finished.</p>
<ul>
<li><p>Make sure all tests pass from sdist:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">sdist</span><span class="o">-</span><span class="n">tests</span>
</pre></div>
</div>
<p>and the three ways of installing (from tarball, repo, local in repo):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">check</span><span class="o">-</span><span class="n">version</span><span class="o">-</span><span class="n">info</span>
</pre></div>
</div>
<p>The last may not raise any errors, but you should detect in the output
lines of this form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;sys_version&#39;</span><span class="p">:</span> <span class="s1">&#39;2.6.6 (r266:84374, Aug 31 2010, 11:00:51) </span><span class="se">\n</span><span class="s1">[GCC 4.0.1 (Apple Inc. build 5493)]&#39;</span><span class="p">,</span> <span class="s1">&#39;commit_source&#39;</span><span class="p">:</span> <span class="s1">&#39;archive substitution&#39;</span><span class="p">,</span> <span class="s1">&#39;np_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;commit_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;25b4125&#39;</span><span class="p">,</span> <span class="s1">&#39;pkg_path&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/folders/jg/jgfZ12ZXHwGSFKD85xLpLk+++TI/-Tmp-/tmpGPiD3E/pylib/nibabel&#39;</span><span class="p">,</span> <span class="s1">&#39;sys_executable&#39;</span><span class="p">:</span> <span class="s1">&#39;/Library/Frameworks/Python.framework/Versions/2.6/Resources/Python.app/Contents/MacOS/Python&#39;</span><span class="p">,</span> <span class="s1">&#39;sys_platform&#39;</span><span class="p">:</span> <span class="s1">&#39;darwin&#39;</span><span class="p">}</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">jg</span><span class="o">/</span><span class="n">jgfZ12ZXHwGSFKD85xLpLk</span><span class="o">+++</span><span class="n">TI</span><span class="o">/-</span><span class="n">Tmp</span><span class="o">-/</span><span class="n">tmpGPiD3E</span><span class="o">/</span><span class="n">pylib</span><span class="o">/</span><span class="n">nibabel</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">pyc</span>
<span class="p">{</span><span class="s1">&#39;sys_version&#39;</span><span class="p">:</span> <span class="s1">&#39;2.6.6 (r266:84374, Aug 31 2010, 11:00:51) </span><span class="se">\n</span><span class="s1">[GCC 4.0.1 (Apple Inc. build 5493)]&#39;</span><span class="p">,</span> <span class="s1">&#39;commit_source&#39;</span><span class="p">:</span> <span class="s1">&#39;installation&#39;</span><span class="p">,</span> <span class="s1">&#39;np_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;commit_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;25b4125&#39;</span><span class="p">,</span> <span class="s1">&#39;pkg_path&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/folders/jg/jgfZ12ZXHwGSFKD85xLpLk+++TI/-Tmp-/tmpGPiD3E/pylib/nibabel&#39;</span><span class="p">,</span> <span class="s1">&#39;sys_executable&#39;</span><span class="p">:</span> <span class="s1">&#39;/Library/Frameworks/Python.framework/Versions/2.6/Resources/Python.app/Contents/MacOS/Python&#39;</span><span class="p">,</span> <span class="s1">&#39;sys_platform&#39;</span><span class="p">:</span> <span class="s1">&#39;darwin&#39;</span><span class="p">}</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">mb312</span><span class="o">/</span><span class="n">dev_trees</span><span class="o">/</span><span class="n">nibabel</span><span class="o">/</span><span class="n">nibabel</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">pyc</span>
<span class="p">{</span><span class="s1">&#39;sys_version&#39;</span><span class="p">:</span> <span class="s1">&#39;2.6.6 (r266:84374, Aug 31 2010, 11:00:51) </span><span class="se">\n</span><span class="s1">[GCC 4.0.1 (Apple Inc. build 5493)]&#39;</span><span class="p">,</span> <span class="s1">&#39;commit_source&#39;</span><span class="p">:</span> <span class="s1">&#39;repository&#39;</span><span class="p">,</span> <span class="s1">&#39;np_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;commit_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;25b4125&#39;</span><span class="p">,</span> <span class="s1">&#39;pkg_path&#39;</span><span class="p">:</span> <span class="s1">&#39;/Users/mb312/dev_trees/nibabel/nibabel&#39;</span><span class="p">,</span> <span class="s1">&#39;sys_executable&#39;</span><span class="p">:</span> <span class="s1">&#39;/Library/Frameworks/Python.framework/Versions/2.6/Resources/Python.app/Contents/MacOS/Python&#39;</span><span class="p">,</span> <span class="s1">&#39;sys_platform&#39;</span><span class="p">:</span> <span class="s1">&#39;darwin&#39;</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Check the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file is picking up all the library code and scripts,
with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">check</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<p>Look for output at the end about missed files, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Missed</span> <span class="n">script</span> <span class="n">files</span><span class="p">:</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">mb312</span><span class="o">/</span><span class="n">dev_trees</span><span class="o">/</span><span class="n">nibabel</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">nib</span><span class="o">-</span><span class="n">dicomfs</span><span class="p">,</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">mb312</span><span class="o">/</span><span class="n">dev_trees</span><span class="o">/</span><span class="n">nibabel</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">nifti1_diagnose</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Fix <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> to carry across any files that should be in the
distribution.</p>
</li>
<li><p>Check the documentation doctests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">doc</span> <span class="n">doctest</span>
</pre></div>
</div>
<p>This should also be tested by <a class="reference external" href="https://travis-ci.org/nipy/nibabel">nibabel on travis</a>.</p>
</li>
<li><p>Check everything compiles without syntax errors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">compileall</span> <span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>Check that nibabel correctly generates a source distribution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">source</span><span class="o">-</span><span class="n">release</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">nibabel/info.py</span></code> to set <code class="docutils literal notranslate"><span class="pre">_version_extra</span></code> to <code class="docutils literal notranslate"><span class="pre">''</span></code>; commit;</p></li>
<li><p>You may have virtualenvs for different Python versions.  Check the tests
pass for different configurations. The long-hand way looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workon</span> <span class="n">python26</span>
<span class="n">make</span> <span class="n">distclean</span>
<span class="n">make</span> <span class="n">sdist</span><span class="o">-</span><span class="n">tests</span>
<span class="n">deactivate</span>
</pre></div>
</div>
<p>etc for the different virtualenvs;</p>
</li>
<li><p>Check on different platforms, particularly windows and PPC. Look at the
<a class="reference external" href="https://nipy.bic.berkeley.edu">nipy buildbot</a> automated test runs for this;</p></li>
<li><p>Force build of your release candidate branch with the slow and big-memory
tests on the <code class="docutils literal notranslate"><span class="pre">zibi</span></code> buildslave:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">py2</span><span class="mf">.7</span><span class="o">-</span><span class="n">osx</span><span class="o">-</span><span class="mf">10.10</span>
</pre></div>
</div>
<p>Check the build web-page for errors:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-py2.7-osx-10.10">https://nipy.bic.berkeley.edu/builders/nibabel-py2.7-osx-10.10</a></p></li>
</ul>
</li>
<li><p>Force builds of your local branch on the win32 and amd64 binaries on
buildbot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">bdist32</span><span class="o">-</span><span class="mi">27</span>
<span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">bdist32</span><span class="o">-</span><span class="mi">33</span>
<span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">bdist32</span><span class="o">-</span><span class="mi">34</span>
<span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">bdist32</span><span class="o">-</span><span class="mi">35</span>
<span class="n">try_branch</span><span class="o">.</span><span class="n">py</span> <span class="n">nibabel</span><span class="o">-</span><span class="n">bdist64</span><span class="o">-</span><span class="mi">27</span>
</pre></div>
</div>
<p>Check the builds completed without error on their respective web-pages:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-27">https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-27</a></p></li>
<li><p><a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-33">https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-33</a></p></li>
<li><p><a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-34">https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-34</a></p></li>
<li><p><a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-35">https://nipy.bic.berkeley.edu/builders/nibabel-bdist32-35</a></p></li>
<li><p><a class="reference external" href="https://nipy.bic.berkeley.edu/builders/nibabel-bdist64-27">https://nipy.bic.berkeley.edu/builders/nibabel-bdist64-27</a></p></li>
</ul>
</li>
<li><p>Make sure you have <a class="reference external" href="https://travis-ci.org">travis-ci</a> building set up for your own repo. Make a new
<code class="docutils literal notranslate"><span class="pre">release-check</span></code> (or similar) branch, and push the code in its current
state to a branch that will build, e.g:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">D</span> <span class="n">release</span><span class="o">-</span><span class="n">check</span> <span class="c1"># in case branch already exists</span>
<span class="n">git</span> <span class="n">co</span> <span class="o">-</span><span class="n">b</span> <span class="n">release</span><span class="o">-</span><span class="n">check</span>
<span class="c1"># You might need the --force flag here</span>
<span class="n">git</span> <span class="n">push</span> <span class="n">your</span><span class="o">-</span><span class="n">github</span><span class="o">-</span><span class="n">user</span> <span class="n">release</span><span class="o">-</span><span class="n">check</span> <span class="o">-</span><span class="n">u</span>
</pre></div>
</div>
</li>
<li><p>Once everything looks good, you are ready to upload the source release to
PyPi.  See <a class="reference external" href="https://pythonhosted.org/an_example_pypi_project/setuptools.html">setuptools intro</a>.  Make sure you have a file
<code class="docutils literal notranslate"><span class="pre">\$HOME/.pypirc</span></code>, of form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">distutils</span><span class="p">]</span>
<span class="n">index</span><span class="o">-</span><span class="n">servers</span> <span class="o">=</span>
    <span class="n">pypi</span>
    <span class="n">warehouse</span>

<span class="p">[</span><span class="n">pypi</span><span class="p">]</span>
<span class="n">username</span><span class="p">:</span><span class="n">your</span><span class="o">.</span><span class="n">pypi</span><span class="o">.</span><span class="n">username</span>
<span class="n">password</span><span class="p">:</span><span class="n">your</span><span class="o">-</span><span class="n">password</span>

<span class="p">[</span><span class="n">warehouse</span><span class="p">]</span>
<span class="n">repository</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">upload</span><span class="o">.</span><span class="n">pypi</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">legacy</span><span class="o">/</span>
<span class="n">username</span><span class="p">:</span><span class="n">your</span><span class="o">.</span><span class="n">pypi</span><span class="o">.</span><span class="n">username</span>
<span class="n">password</span><span class="p">:</span><span class="n">your</span><span class="o">-</span><span class="n">password</span>
</pre></div>
</div>
</li>
<li><p>Clean:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">distclean</span>
<span class="c1"># Check no files outside version control that you want to keep</span>
<span class="n">git</span> <span class="n">status</span>
<span class="c1"># Nuke</span>
<span class="n">git</span> <span class="n">clean</span> <span class="o">-</span><span class="n">fxd</span>
</pre></div>
</div>
</li>
<li><p>When ready:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">register</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">sdist</span> <span class="o">--</span><span class="n">formats</span><span class="o">=</span><span class="n">gztar</span><span class="p">,</span><span class="nb">zip</span>
<span class="c1"># -s flag to sign the release</span>
<span class="n">twine</span> <span class="n">upload</span> <span class="o">-</span><span class="n">r</span> <span class="n">warehouse</span> <span class="o">-</span><span class="n">s</span> <span class="n">dist</span><span class="o">/</span><span class="n">nibabel</span><span class="o">*</span>
</pre></div>
</div>
</li>
<li><p>Tag the release with signed tag of form <code class="docutils literal notranslate"><span class="pre">2.0.0</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">tag</span> <span class="o">-</span><span class="n">s</span> <span class="mf">2.0.0</span>
</pre></div>
</div>
</li>
<li><p>Push the tag and any other changes to trunk with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="mf">2.0.0</span>
<span class="n">git</span> <span class="n">push</span>
</pre></div>
</div>
</li>
<li><p>Now the version number is OK, push the docs to github pages with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">upload</span><span class="o">-</span><span class="n">html</span>
</pre></div>
</div>
</li>
<li><p>Finally (for the release uploads) upload the Windows binaries you built with
<code class="docutils literal notranslate"><span class="pre">try_branch.py</span></code> above;</p></li>
<li><p>Set up maintenance / development branches</p>
<p>If this is this is a full release you need to set up two branches, one for
further substantial development (often called ‘trunk’) and another for
maintenance releases.</p>
<ul>
<li><p>Branch to maintenance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">co</span> <span class="o">-</span><span class="n">b</span> <span class="n">maint</span><span class="o">/</span><span class="mf">2.0</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">_version_extra</span></code> back to <code class="docutils literal notranslate"><span class="pre">.dev</span></code> and bump <code class="docutils literal notranslate"><span class="pre">_version_micro</span></code> by 1.
Thus the maintenance series will have version numbers like - say -
‘2.0.1.dev’ until the next maintenance release - say ‘2.0.1’.  Commit.
Don’t forget to push upstream with something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span><span class="o">-</span><span class="n">remote</span> <span class="n">maint</span><span class="o">/</span><span class="mf">2.0</span><span class="o">.</span><span class="n">x</span> <span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">upstream</span>
</pre></div>
</div>
</li>
<li><p>Start next development series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">co</span> <span class="n">main</span><span class="o">-</span><span class="n">master</span>
</pre></div>
</div>
<p>then restore <code class="docutils literal notranslate"><span class="pre">.dev</span></code> to <code class="docutils literal notranslate"><span class="pre">_version_extra</span></code>, and bump <code class="docutils literal notranslate"><span class="pre">_version_minor</span></code>
by 1.  Thus the development series (‘trunk’) will have a version number
here of ‘2.1.0.dev’ and the next full release will be ‘2.1.0’.</p>
<p>Next merge the maintenance branch with the “ours” strategy.  This just
labels the maintenance <cite>info.py</cite> edits as seen but discarded, so we can
merge from maintenance in future without getting spurious merge conflicts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">merge</span> <span class="o">-</span><span class="n">s</span> <span class="n">ours</span> <span class="n">maint</span><span class="o">/</span><span class="mf">2.0</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</li>
</ul>
<p>If this is just a maintenance release from <code class="docutils literal notranslate"><span class="pre">maint/2.0.x</span></code> or similar, just
tag and set the version number to - say - <code class="docutils literal notranslate"><span class="pre">2.0.2.dev</span></code>.</p>
</li>
<li><p>Push the main branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span><span class="o">-</span><span class="n">remote</span> <span class="n">main</span><span class="o">-</span><span class="n">master</span>
</pre></div>
</div>
</li>
<li><p>Make next development release tag</p>
<blockquote>
<div><p>After each release the master branch should be tagged
with an annotated (or/and signed) tag, naming the intended
next version, plus an ‘upstream/’ prefix and ‘dev’ suffix.
For example ‘upstream/1.0.0.dev’ means “development start
for upcoming version 1.0.0.</p>
<p>This tag is used in the Makefile rules to create development snapshot
releases to create proper versions for those. The version derives its name
from the last available annotated tag, the number of commits since that,
and an abbreviated SHA1. See the docs of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">describe</span></code> for more info.</p>
<p>Please take a look at the Makefile rules <code class="docutils literal notranslate"><span class="pre">devel-src</span></code>, <code class="docutils literal notranslate"><span class="pre">devel-dsc</span></code> and
<code class="docutils literal notranslate"><span class="pre">orig-src</span></code>.</p>
</div></blockquote>
</li>
<li><p>Go to: <a class="reference external" href="https://github.com/nipy/nibabel/tags">https://github.com/nipy/nibabel/tags</a> and select the new tag, to fill
in the release notes.  Copy the relevant part of the Changelog into the
release notes.  Click on “Publish release”.  This will cause <a class="reference external" href="https://zenodo.org">Zenodo</a> to
generate a new release “upload”, including a DOI.  After a few minutes, go
to <a class="reference external" href="https://zenodo.org/deposit">https://zenodo.org/deposit</a> and click on the new release upload.  Click on
the “View” button and click on the DOI badge at the right to display the
text for adding a DOI badge in various formats. Copy the DOI Markdown text.
The markdown will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[![DOI](https://zenodo.org/badge/doi/10.5281/zenodo.60847.svg)](https://doi.org/10.5281/zenodo.60847)
</pre></div>
</div>
<p>Go back to the Github release page for this release, click “Edit release”.
and copy the DOI into the release notes.  Click “Update release”.</p>
<p>See: <a class="reference external" href="https://guides.github.com/activities/citable-code">https://guides.github.com/activities/citable-code</a></p>
</li>
<li><p>Announce to the mailing lists.</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2006, NiBabel developers &lt;neuroimaging@python.org&gt;.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    </div>
  </body>
</html>